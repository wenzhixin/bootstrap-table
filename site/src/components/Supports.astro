---
import Config from '@/config.js'
import { getLangFromUrl, useTranslations } from '@/i18n/utils'
import { ui } from '@/i18n/ui'

const lang = getLangFromUrl(Astro.url)
const t = useTranslations(Astro.url)

const translations = ui[lang]
---

<div class="container border-bottom supports-container">
  <div class="pt-5">
    <h3>{t('supports.title')}</h3>

    <div>
      {t('supports.description')}
    </div>
  </div>

  <div id="supports">
    <div class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2">{t('supports.loading')}</p>
    </div>
  </div>
</div>

<script define:vars={{
  baseurl: Config.baseurl,
  version: Config.currentVersion,
  translations
}}>
  /* eslint-disable no-undef */
  const script = document.createElement('script')

  script.src = `${baseurl}/assets/js/supports.js?v=${version}`
  script.onload = () => {
    if (window.Supports && window.Supports.initSupports) {
      window.Supports.initSupports(translations)
    }
  }
  document.head.appendChild(script)
</script>
